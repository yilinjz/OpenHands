+ source /opt/miniconda3/bin/activate
++ _CONDA_ROOT=/opt/miniconda3
++ . /opt/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/opt/miniconda3/bin/conda
+++ CONDA_EXE=/opt/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /opt/miniconda3/bin/conda
++++ dirname /opt/miniconda3/bin
+++ PATH=/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate
+++ /opt/miniconda3/bin/conda shell.posix activate
++ ask_conda='PS1='\''(base) '\''
export PATH='\''/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\''
export CONDA_PREFIX='\''/opt/miniconda3'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''base'\''
export CONDA_PROMPT_MODIFIER='\''(base) '\''
export CONDA_EXE='\''/opt/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/opt/miniconda3/bin/python'\'''
++ eval 'PS1='\''(base) '\''
export PATH='\''/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\''
export CONDA_PREFIX='\''/opt/miniconda3'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''base'\''
export CONDA_PROMPT_MODIFIER='\''(base) '\''
export CONDA_EXE='\''/opt/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/opt/miniconda3/bin/python'\'''
+++ PS1='(base) '
+++ export PATH=/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
+++ PATH=/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
+++ export CONDA_PREFIX=/opt/miniconda3
+++ CONDA_PREFIX=/opt/miniconda3
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=base
+++ CONDA_DEFAULT_ENV=base
+++ export 'CONDA_PROMPT_MODIFIER=(base) '
+++ CONDA_PROMPT_MODIFIER='(base) '
+++ export CONDA_EXE=/opt/miniconda3/bin/conda
+++ CONDA_EXE=/opt/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ conda activate testbed
+ local cmd=activate
+ case "$cmd" in
+ __conda_activate activate testbed
+ '[' -n '' ']'
+ local ask_conda
++ PS1='(base) '
++ __conda_exe shell.posix activate testbed
++ /opt/miniconda3/bin/conda shell.posix activate testbed
+ ask_conda='PS1='\''(testbed) '\''
export PATH='\''/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\''
export CONDA_PREFIX='\''/opt/miniconda3/envs/testbed'\''
export CONDA_SHLVL='\''2'\''
export CONDA_DEFAULT_ENV='\''testbed'\''
export CONDA_PROMPT_MODIFIER='\''(testbed) '\''
export CONDA_PREFIX_1='\''/opt/miniconda3'\''
export CONDA_EXE='\''/opt/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/opt/miniconda3/bin/python'\'''
+ eval 'PS1='\''(testbed) '\''
export PATH='\''/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\''
export CONDA_PREFIX='\''/opt/miniconda3/envs/testbed'\''
export CONDA_SHLVL='\''2'\''
export CONDA_DEFAULT_ENV='\''testbed'\''
export CONDA_PROMPT_MODIFIER='\''(testbed) '\''
export CONDA_PREFIX_1='\''/opt/miniconda3'\''
export CONDA_EXE='\''/opt/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/opt/miniconda3/bin/python'\'''
++ PS1='(testbed) '
++ export PATH=/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
++ PATH=/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
++ export CONDA_PREFIX=/opt/miniconda3/envs/testbed
++ CONDA_PREFIX=/opt/miniconda3/envs/testbed
++ export CONDA_SHLVL=2
++ CONDA_SHLVL=2
++ export CONDA_DEFAULT_ENV=testbed
++ CONDA_DEFAULT_ENV=testbed
++ export 'CONDA_PROMPT_MODIFIER=(testbed) '
++ CONDA_PROMPT_MODIFIER='(testbed) '
++ export CONDA_PREFIX_1=/opt/miniconda3
++ CONDA_PREFIX_1=/opt/miniconda3
++ export CONDA_EXE=/opt/miniconda3/bin/conda
++ CONDA_EXE=/opt/miniconda3/bin/conda
++ export _CE_M=
++ _CE_M=
++ export _CE_CONDA=
++ _CE_CONDA=
++ export CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
++ CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
+ __conda_hashr
+ '[' -n '' ']'
+ '[' -n '' ']'
+ hash -r
+ cd /testbed
+ git config --global --add safe.directory /testbed
+ cd /testbed
+ git status
On branch main
Changes not staged for commit:
  (use "git add <file>..." to update what will be committed)
  (use "git restore <file>..." to discard changes in working directory)
	modified:   requests/exceptions.py

no changes added to commit (use "git add" and/or "git commit -a")
+ git show
commit 0be38a0c37c59c4b66ce908731da15b401655113
Merge: 2b26489f beaa7e41
Author: Ian Cordasco <sigmavirus24@users.noreply.github.com>
Date:   Wed Jul 15 20:51:06 2015 -0500

    Merge pull request #2672 from petedmarsh/fix-custom-headers-example
    
    Fix quickstart "Custom Headers" example intro

+ git -c core.fileMode=false diff 0be38a0c37c59c4b66ce908731da15b401655113
diff --git a/requests/exceptions.py b/requests/exceptions.py
index 89135a80..898876f9 100644
--- a/requests/exceptions.py
+++ b/requests/exceptions.py
@@ -7,7 +7,10 @@ requests.exceptions
 This module contains the set of Requests' exceptions.
 
 """
+# Grab the base exception from urllib3
 from .packages.urllib3.exceptions import HTTPError as BaseHTTPError
+# Grab the specific exceptions from urllib3
+from .packages.urllib3.exceptions import (TimeoutError as Urllib3TimeoutError, ConnectTimeoutError as Urllib3ConnectTimeoutError, ReadTimeoutError as Urllib3ReadTimeoutError, DecodeError as Urllib3DecodeError)
 
 
 class RequestException(IOError):
@@ -52,12 +55,12 @@ class Timeout(RequestException):
     """
 
 
-class ConnectTimeout(ConnectionError, Timeout):
+class ConnectTimeout(ConnectionError, Timeout, Urllib3ConnectTimeoutError):
     """The request timed out while trying to connect to the remote server.
 
     Requests that produced this error are safe to retry.
     """
-
+    # Note: Inherits from Urllib3ConnectTimeoutError for broader catch compatibility.
 
 class ReadTimeout(Timeout):
     """The server did not send any data in the allotted amount of time."""
@@ -87,7 +90,7 @@ class ChunkedEncodingError(RequestException):
     """The server declared chunked encoding but sent an invalid chunk."""
 
 
-class ContentDecodingError(RequestException, BaseHTTPError):
+class ContentDecodingError(RequestException, Urllib3DecodeError):
     """Failed to decode response content"""
 
 
+ source /opt/miniconda3/bin/activate
++ _CONDA_ROOT=/opt/miniconda3
++ . /opt/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/opt/miniconda3/bin/conda
+++ CONDA_EXE=/opt/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
+++ '[' -z x ']'
++ conda activate
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate
++ '[' -n '' ']'
++ local ask_conda
+++ PS1='(testbed) '
+++ __conda_exe shell.posix activate
+++ /opt/miniconda3/bin/conda shell.posix activate
++ ask_conda='PS1='\''(base) '\''
export PATH='\''/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\''
export CONDA_PREFIX='\''/opt/miniconda3'\''
export CONDA_SHLVL='\''3'\''
export CONDA_DEFAULT_ENV='\''base'\''
export CONDA_PROMPT_MODIFIER='\''(base) '\''
export CONDA_PREFIX_2='\''/opt/miniconda3/envs/testbed'\''
export CONDA_EXE='\''/opt/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/opt/miniconda3/bin/python'\'''
++ eval 'PS1='\''(base) '\''
export PATH='\''/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\''
export CONDA_PREFIX='\''/opt/miniconda3'\''
export CONDA_SHLVL='\''3'\''
export CONDA_DEFAULT_ENV='\''base'\''
export CONDA_PROMPT_MODIFIER='\''(base) '\''
export CONDA_PREFIX_2='\''/opt/miniconda3/envs/testbed'\''
export CONDA_EXE='\''/opt/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/opt/miniconda3/bin/python'\'''
+++ PS1='(base) '
+++ export PATH=/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
+++ PATH=/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
+++ export CONDA_PREFIX=/opt/miniconda3
+++ CONDA_PREFIX=/opt/miniconda3
+++ export CONDA_SHLVL=3
+++ CONDA_SHLVL=3
+++ export CONDA_DEFAULT_ENV=base
+++ CONDA_DEFAULT_ENV=base
+++ export 'CONDA_PROMPT_MODIFIER=(base) '
+++ CONDA_PROMPT_MODIFIER='(base) '
+++ export CONDA_PREFIX_2=/opt/miniconda3/envs/testbed
+++ CONDA_PREFIX_2=/opt/miniconda3/envs/testbed
+++ export CONDA_EXE=/opt/miniconda3/bin/conda
+++ CONDA_EXE=/opt/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ conda activate testbed
+ local cmd=activate
+ case "$cmd" in
+ __conda_activate activate testbed
+ '[' -n '' ']'
+ local ask_conda
++ PS1='(base) '
++ __conda_exe shell.posix activate testbed
++ /opt/miniconda3/bin/conda shell.posix activate testbed
+ ask_conda='PS1='\''(testbed) '\''
export PATH='\''/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\''
export CONDA_PREFIX='\''/opt/miniconda3/envs/testbed'\''
export CONDA_SHLVL='\''4'\''
export CONDA_DEFAULT_ENV='\''testbed'\''
export CONDA_PROMPT_MODIFIER='\''(testbed) '\''
export CONDA_PREFIX_3='\''/opt/miniconda3'\''
export CONDA_EXE='\''/opt/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/opt/miniconda3/bin/python'\'''
+ eval 'PS1='\''(testbed) '\''
export PATH='\''/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\''
export CONDA_PREFIX='\''/opt/miniconda3/envs/testbed'\''
export CONDA_SHLVL='\''4'\''
export CONDA_DEFAULT_ENV='\''testbed'\''
export CONDA_PROMPT_MODIFIER='\''(testbed) '\''
export CONDA_PREFIX_3='\''/opt/miniconda3'\''
export CONDA_EXE='\''/opt/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/opt/miniconda3/bin/python'\'''
++ PS1='(testbed) '
++ export PATH=/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
++ PATH=/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
++ export CONDA_PREFIX=/opt/miniconda3/envs/testbed
++ CONDA_PREFIX=/opt/miniconda3/envs/testbed
++ export CONDA_SHLVL=4
++ CONDA_SHLVL=4
++ export CONDA_DEFAULT_ENV=testbed
++ CONDA_DEFAULT_ENV=testbed
++ export 'CONDA_PROMPT_MODIFIER=(testbed) '
++ CONDA_PROMPT_MODIFIER='(testbed) '
++ export CONDA_PREFIX_3=/opt/miniconda3
++ CONDA_PREFIX_3=/opt/miniconda3
++ export CONDA_EXE=/opt/miniconda3/bin/conda
++ CONDA_EXE=/opt/miniconda3/bin/conda
++ export _CE_M=
++ _CE_M=
++ export _CE_CONDA=
++ _CE_CONDA=
++ export CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
++ CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
+ __conda_hashr
+ '[' -n '' ']'
+ '[' -n '' ']'
+ hash -r
+ python -m pip install .
Processing /testbed
  Preparing metadata (setup.py): started
  Preparing metadata (setup.py): finished with status 'done'
Building wheels for collected packages: requests
  Building wheel for requests (setup.py): started
  Building wheel for requests (setup.py): finished with status 'done'
  Created wheel for requests: filename=requests-2.7.0-py2.py3-none-any.whl size=462715 sha256=74b211e516b765e9fa8c4e97ddcd4c6a65b86488c8322229b40967a3acec800f
  Stored in directory: /tmp/pip-ephem-wheel-cache-yttqd0mx/wheels/7d/66/67/70d1ee2124ccf21d601c352e25cdca10f611f7c8b3f9ffb9e4
Successfully built requests
Installing collected packages: requests
  Attempting uninstall: requests
    Found existing installation: requests 2.7.0
    Uninstalling requests-2.7.0:
      Successfully uninstalled requests-2.7.0
Successfully installed requests-2.7.0
WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable.It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.
+ git checkout 0be38a0c37c59c4b66ce908731da15b401655113 test_requests.py
Updated 0 paths from ccc7cab3
+ git apply -v -
Checking patch test_requests.py...
Applied patch test_requests.py cleanly.
+ : '>>>>> Start Test Output'
+ pytest -rA test_requests.py
============================= test session starts ==============================
platform linux -- Python 3.9.20, pytest-7.4.4, pluggy-1.0.0
rootdir: /testbed
collected 162 items

test_requests.py ..........................F............F.F..F.......... [ 33%]
..F..FF...F.F..F..F.F..F...Fx..FF......FF.FFF........................... [ 78%]
.....................FF..F......FF.                                      [100%]

=================================== FAILURES ===================================
________________ RequestsTestCase.test_conflicting_post_params _________________

self = <test_requests.RequestsTestCase testMethod=test_conflicting_post_params>

    def test_conflicting_post_params(self):
        url = httpbin('post')
        with open('requirements.txt') as f:
>           pytest.raises(ValueError, "requests.post(url, data='[{\"some\": \"data\"}]', files={'some': f})")
E           TypeError: 'requests.post(url, data=\'[{"some": "data"}]\', files={\'some\': f})' object (type: <class 'str'>) must be callable

test_requests.py:455: TypeError
__________________ RequestsTestCase.test_custom_content_type ___________________

self = <test_requests.RequestsTestCase testMethod=test_custom_content_type>

    def test_custom_content_type(self):
        r = requests.post(
            httpbin('post'),
            data={'stuff': json.dumps({'a': 123})},
            files={'file1': ('test_requests.py', open(__file__, 'rb')),
                   'file2': ('test_requests', open(__file__, 'rb'),
                             'text/py-content-type')})
>       assert r.status_code == 200
E       assert 503 == 200
E        +  where 503 = <Response [503]>.status_code

test_requests.py:549: AssertionError
__________ RequestsTestCase.test_different_encodings_dont_break_post ___________

self = <test_requests.RequestsTestCase testMethod=test_different_encodings_dont_break_post>

    def test_different_encodings_dont_break_post(self):
        r = requests.post(httpbin('post'),
            data={'stuff': json.dumps({'a': 123})},
            params={'blah': 'asdf1234'},
            files={'file': ('test_requests.py', open(__file__, 'rb'))})
>       assert r.status_code == 200
E       assert 503 == 200
E        +  where 503 = <Response [503]>.status_code

test_requests.py:502: AssertionError
________________ RequestsTestCase.test_generic_cookiejar_works _________________

self = <test_requests.RequestsTestCase testMethod=test_generic_cookiejar_works>

    def test_generic_cookiejar_works(self):
        cj = cookielib.CookieJar()
        cookiejar_from_dict({'foo': 'bar'}, cj)
        s = requests.session()
        s.cookies = cj
        r = s.get(httpbin('cookies'))
        # Make sure the cookie was sent
>       assert r.json()['cookies']['foo'] == 'bar'

test_requests.py:230: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
requests/models.py:805: in json
    return complexjson.loads(self.text, **kwargs)
/opt/miniconda3/envs/testbed/lib/python3.9/json/__init__.py:346: in loads
    return _default_decoder.decode(s)
/opt/miniconda3/envs/testbed/lib/python3.9/json/decoder.py:337: in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <json.decoder.JSONDecoder object at 0x7fc4dbe1e8b0>
s = '<html>\r\n<head><title>503 Service Temporarily Unavailable</title></head>\r\n<body>\r\n<center><h1>503 Service Temporarily Unavailable</h1></center>\r\n</body>\r\n</html>\r\n'
idx = 0

    def raw_decode(self, s, idx=0):
        """Decode a JSON document from ``s`` (a ``str`` beginning with
        a JSON document) and return a 2-tuple of the Python
        representation and the index in ``s`` where the document ended.
    
        This can be used to decode a JSON document from a string that may
        have extraneous data at the end.
    
        """
        try:
            obj, end = self.scan_once(s, idx)
        except StopIteration as err:
>           raise JSONDecodeError("Expecting value", s, err.value) from None
E           json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)

/opt/miniconda3/envs/testbed/lib/python3.9/json/decoder.py:355: JSONDecodeError
___________ RequestsTestCase.test_json_param_post_content_type_works ___________

self = <test_requests.RequestsTestCase testMethod=test_json_param_post_content_type_works>

    def test_json_param_post_content_type_works(self):
        r = requests.post(
            httpbin('post'),
            json={'life': 42}
        )
>       assert r.status_code == 200
E       assert 503 == 200
E        +  where 503 = <Response [503]>.status_code

test_requests.py:1052: AssertionError
_________ RequestsTestCase.test_manual_redirect_with_partial_body_read _________

self = <test_requests.RequestsTestCase testMethod=test_manual_redirect_with_partial_body_read>

    def test_manual_redirect_with_partial_body_read(self):
        s = requests.Session()
        r1 = s.get(httpbin('redirect/2'), allow_redirects=False, stream=True)
>       assert r1.is_redirect
E       assert False
E        +  where False = <Response [503]>.is_redirect

test_requests.py:998: AssertionError
______________ RequestsTestCase.test_mixed_case_scheme_acceptable ______________

self = <test_requests.RequestsTestCase testMethod=test_mixed_case_scheme_acceptable>

    def test_mixed_case_scheme_acceptable(self):
        s = requests.Session()
        s.proxies = getproxies()
        parts = urlparse(httpbin('get'))
        schemes = ['http://', 'HTTP://', 'hTTp://', 'HttP://',
                   'https://', 'HTTPS://', 'hTTps://', 'HttPs://']
        for scheme in schemes:
            url = scheme + parts.netloc + parts.path
            r = requests.Request('GET', url)
            r = s.send(r.prepare())
>           assert r.status_code == 200, 'failed for scheme {0}'.format(scheme)
E           AssertionError: failed for scheme http://
E           assert 503 == 200
E            +  where 503 = <Response [503]>.status_code

test_requests.py:138: AssertionError
_________________ RequestsTestCase.test_param_cookiejar_works __________________

self = <test_requests.RequestsTestCase testMethod=test_param_cookiejar_works>

    def test_param_cookiejar_works(self):
        cj = cookielib.CookieJar()
        cookiejar_from_dict({'foo': 'bar'}, cj)
        s = requests.session()
        r = s.get(httpbin('cookies'), cookies=cj)
        # Make sure the cookie was sent
>       assert r.json()['cookies']['foo'] == 'bar'

test_requests.py:240: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
requests/models.py:805: in json
    return complexjson.loads(self.text, **kwargs)
/opt/miniconda3/envs/testbed/lib/python3.9/json/__init__.py:346: in loads
    return _default_decoder.decode(s)
/opt/miniconda3/envs/testbed/lib/python3.9/json/decoder.py:337: in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <json.decoder.JSONDecoder object at 0x7fc4dbe1e8b0>
s = '<html>\r\n<head><title>503 Service Temporarily Unavailable</title></head>\r\n<body>\r\n<center><h1>503 Service Temporarily Unavailable</h1></center>\r\n</body>\r\n</html>\r\n'
idx = 0

    def raw_decode(self, s, idx=0):
        """Decode a JSON document from ``s`` (a ``str`` beginning with
        a JSON document) and return a 2-tuple of the Python
        representation and the index in ``s`` where the document ended.
    
        This can be used to decode a JSON document from a string that may
        have extraneous data at the end.
    
        """
        try:
            obj, end = self.scan_once(s, idx)
        except StopIteration as err:
>           raise JSONDecodeError("Expecting value", s, err.value) from None
E           json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)

/opt/miniconda3/envs/testbed/lib/python3.9/json/decoder.py:355: JSONDecodeError
____________ RequestsTestCase.test_params_are_merged_case_sensitive ____________

self = <test_requests.RequestsTestCase testMethod=test_params_are_merged_case_sensitive>

    def test_params_are_merged_case_sensitive(self):
        s = requests.Session()
        s.params['foo'] = 'bar'
        r = s.get(httpbin('get'), params={'FOO': 'bar'})
>       assert r.json()['args'] == {'foo': 'bar', 'FOO': 'bar'}

test_requests.py:910: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
requests/models.py:805: in json
    return complexjson.loads(self.text, **kwargs)
/opt/miniconda3/envs/testbed/lib/python3.9/json/__init__.py:346: in loads
    return _default_decoder.decode(s)
/opt/miniconda3/envs/testbed/lib/python3.9/json/decoder.py:337: in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <json.decoder.JSONDecoder object at 0x7fc4dbe1e8b0>
s = '<html>\r\n<head><title>503 Service Temporarily Unavailable</title></head>\r\n<body>\r\n<center><h1>503 Service Temporarily Unavailable</h1></center>\r\n</body>\r\n</html>\r\n'
idx = 0

    def raw_decode(self, s, idx=0):
        """Decode a JSON document from ``s`` (a ``str`` beginning with
        a JSON document) and return a 2-tuple of the Python
        representation and the index in ``s`` where the document ended.
    
        This can be used to decode a JSON document from a string that may
        have extraneous data at the end.
    
        """
        try:
            obj, end = self.scan_once(s, idx)
        except StopIteration as err:
>           raise JSONDecodeError("Expecting value", s, err.value) from None
E           json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)

/opt/miniconda3/envs/testbed/lib/python3.9/json/decoder.py:355: JSONDecodeError
_________________ RequestsTestCase.test_prepared_from_session __________________

self = <test_requests.RequestsTestCase testMethod=test_prepared_from_session>

    def test_prepared_from_session(self):
        class DummyAuth(requests.auth.AuthBase):
            def __call__(self, r):
                r.headers['Dummy-Auth-Test'] = 'dummy-auth-test-ok'
                return r
    
        req = requests.Request('GET', httpbin('headers'))
        assert not req.auth
    
        s = requests.Session()
        s.auth = DummyAuth()
    
        prep = s.prepare_request(req)
        resp = s.send(prep)
    
>       assert resp.json()['headers'][
            'Dummy-Auth-Test'] == 'dummy-auth-test-ok'

test_requests.py:607: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
requests/models.py:805: in json
    return complexjson.loads(self.text, **kwargs)
/opt/miniconda3/envs/testbed/lib/python3.9/json/__init__.py:346: in loads
    return _default_decoder.decode(s)
/opt/miniconda3/envs/testbed/lib/python3.9/json/decoder.py:337: in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <json.decoder.JSONDecoder object at 0x7fc4dbe1e8b0>
s = '<html>\r\n<head><title>503 Service Temporarily Unavailable</title></head>\r\n<body>\r\n<center><h1>503 Service Temporarily Unavailable</h1></center>\r\n</body>\r\n</html>\r\n'
idx = 0

    def raw_decode(self, s, idx=0):
        """Decode a JSON document from ``s`` (a ``str`` beginning with
        a JSON document) and return a 2-tuple of the Python
        representation and the index in ``s`` where the document ended.
    
        This can be used to decode a JSON document from a string that may
        have extraneous data at the end.
    
        """
        try:
            obj, end = self.scan_once(s, idx)
        except StopIteration as err:
>           raise JSONDecodeError("Expecting value", s, err.value) from None
E           json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)

/opt/miniconda3/envs/testbed/lib/python3.9/json/decoder.py:355: JSONDecodeError
___________ RequestsTestCase.test_redirect_with_wrong_gzipped_header ___________

self = <requests.packages.urllib3.response.HTTPResponse object at 0x7fc4db3cfd60>
data = b'<html>\r\n<head><title>503 Service Temporarily Unavailable</title></head>\r\n<body>\r\n<center><h1>503 Service Temporarily Unavailable</h1></center>\r\n</body>\r\n</html>\r\n'
decode_content = True, flush_decoder = False

    def _decode(self, data, decode_content, flush_decoder):
        """
        Decode the data passed in and potentially flush the decoder.
        """
        try:
            if decode_content and self._decoder:
>               data = self._decoder.decompress(data)

requests/packages/urllib3/response.py:192: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <requests.packages.urllib3.response.GzipDecoder object at 0x7fc4db3cf5e0>
data = b'<html>\r\n<head><title>503 Service Temporarily Unavailable</title></head>\r\n<body>\r\n<center><h1>503 Service Temporarily Unavailable</h1></center>\r\n</body>\r\n</html>\r\n'

    def decompress(self, data):
        if not data:
            return data
>       return self._obj.decompress(data)
E       zlib.error: Error -3 while decompressing data: incorrect header check

requests/packages/urllib3/response.py:58: error

During handling of the above exception, another exception occurred:

    def generate():
        # Special case for urllib3.
        if hasattr(self.raw, 'stream'):
            try:
>               for chunk in self.raw.stream(chunk_size, decode_content=True):

requests/models.py:657: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
requests/packages/urllib3/response.py:307: in stream
    data = self.read(amt=amt, decode_content=decode_content)
requests/packages/urllib3/response.py:275: in read
    data = self._decode(data, decode_content, flush_decoder)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <requests.packages.urllib3.response.HTTPResponse object at 0x7fc4db3cfd60>
data = b'<html>\r\n<head><title>503 Service Temporarily Unavailable</title></head>\r\n<body>\r\n<center><h1>503 Service Temporarily Unavailable</h1></center>\r\n</body>\r\n</html>\r\n'
decode_content = True, flush_decoder = False

    def _decode(self, data, decode_content, flush_decoder):
        """
        Decode the data passed in and potentially flush the decoder.
        """
        try:
            if decode_content and self._decoder:
                data = self._decoder.decompress(data)
        except (IOError, zlib.error) as e:
            content_encoding = self.headers.get('content-encoding', '').lower()
>           raise DecodeError(
                "Received response with content-encoding: %s, but "
                "failed to decode it." % content_encoding, e)
E           requests.packages.urllib3.exceptions.DecodeError: ('Received response with content-encoding: gzip, but failed to decode it.', error('Error -3 while decompressing data: incorrect header check'))

requests/packages/urllib3/response.py:195: DecodeError

During handling of the above exception, another exception occurred:

self = <test_requests.RequestsTestCase testMethod=test_redirect_with_wrong_gzipped_header>

    def test_redirect_with_wrong_gzipped_header(self):
        s = requests.Session()
        url = httpbin('redirect/1')
        self._patch_adapter_gzipped_redirect(s, url)
>       s.get(url)

test_requests.py:1032: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
requests/sessions.py:477: in get
    return self.request('GET', url, **kwargs)
requests/sessions.py:465: in request
    resp = self.send(prep, **send_kwargs)
requests/sessions.py:605: in send
    r.content
requests/models.py:734: in content
    self._content = bytes().join(self.iter_content(CONTENT_CHUNK_SIZE)) or bytes()
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

    def generate():
        # Special case for urllib3.
        if hasattr(self.raw, 'stream'):
            try:
                for chunk in self.raw.stream(chunk_size, decode_content=True):
                    yield chunk
            except ProtocolError as e:
                raise ChunkedEncodingError(e)
            except DecodeError as e:
>               raise ContentDecodingError(e)
E               requests.exceptions.ContentDecodingError: ('Received response with content-encoding: gzip, but failed to decode it.', error('Error -3 while decompressing data: incorrect header check'))

requests/models.py:662: ContentDecodingError
________ RequestsTestCase.test_request_cookie_overrides_session_cookie _________

self = <test_requests.RequestsTestCase testMethod=test_request_cookie_overrides_session_cookie>

    def test_request_cookie_overrides_session_cookie(self):
        s = requests.session()
        s.cookies['foo'] = 'bar'
        r = s.get(httpbin('cookies'), cookies={'foo': 'baz'})
>       assert r.json()['cookies']['foo'] == 'baz'

test_requests.py:213: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
requests/models.py:805: in json
    return complexjson.loads(self.text, **kwargs)
/opt/miniconda3/envs/testbed/lib/python3.9/json/__init__.py:346: in loads
    return _default_decoder.decode(s)
/opt/miniconda3/envs/testbed/lib/python3.9/json/decoder.py:337: in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <json.decoder.JSONDecoder object at 0x7fc4dbe1e8b0>
s = '<html>\r\n<head><title>503 Service Temporarily Unavailable</title></head>\r\n<body>\r\n<center><h1>503 Service Temporarily Unavailable</h1></center>\r\n</body>\r\n</html>\r\n'
idx = 0

    def raw_decode(self, s, idx=0):
        """Decode a JSON document from ``s`` (a ``str`` beginning with
        a JSON document) and return a 2-tuple of the Python
        representation and the index in ``s`` where the document ended.
    
        This can be used to decode a JSON document from a string that may
        have extraneous data at the end.
    
        """
        try:
            obj, end = self.scan_once(s, idx)
        except StopIteration as err:
>           raise JSONDecodeError("Expecting value", s, err.value) from None
E           json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)

/opt/miniconda3/envs/testbed/lib/python3.9/json/decoder.py:355: JSONDecodeError
_______________ RequestsTestCase.test_requests_history_is_saved ________________

self = <test_requests.RequestsTestCase testMethod=test_requests_history_is_saved>

    def test_requests_history_is_saved(self):
        r = requests.get(httpbin('redirect/5'))
>       total = r.history[-1].history
E       IndexError: list index out of range

test_requests.py:1041: IndexError
__________________ RequestsTestCase.test_response_iter_lines ___________________

self = <test_requests.RequestsTestCase testMethod=test_response_iter_lines>

    def test_response_iter_lines(self):
        r = requests.get(httpbin('stream/4'), stream=True)
>       assert r.status_code == 200
E       assert 503 == 200
E        +  where 503 = <Response [503]>.status_code

test_requests.py:1058: AssertionError
____________________ RequestsTestCase.test_session_pickling ____________________

self = <test_requests.RequestsTestCase testMethod=test_session_pickling>

    def test_session_pickling(self):
        r = requests.Request('GET', httpbin('get'))
        s = requests.Session()
    
        s = pickle.loads(pickle.dumps(s))
        s.proxies = getproxies()
    
        r = s.send(r.prepare())
>       assert r.status_code == 200
E       assert 503 == 200
E        +  where 503 = <Response [503]>.status_code

test_requests.py:839: AssertionError
___________________ RequestsTestCase.test_set_cookie_on_301 ____________________

self = <test_requests.RequestsTestCase testMethod=test_set_cookie_on_301>

    def test_set_cookie_on_301(self):
        s = requests.session()
        url = httpbin('cookies/set?foo=bar')
        s.get(url)
>       assert s.cookies['foo'] == 'bar'

test_requests.py:177: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
requests/cookies.py:283: in __getitem__
    return self._find_no_duplicates(name)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <RequestsCookieJar[]>, name = 'foo', domain = None, path = None

    def _find_no_duplicates(self, name, domain=None, path=None):
        """Both ``__get_item__`` and ``get`` call this function: it's never
        used elsewhere in Requests. Takes as args name and optional domain and
        path. Returns a cookie.value. Throws KeyError if cookie is not found
        and CookieConflictError if there are multiple cookies that match name
        and optionally domain and path."""
        toReturn = None
        for cookie in iter(self):
            if cookie.name == name:
                if domain is None or cookie.domain == domain:
                    if path is None or cookie.path == path:
                        if toReturn is not None:  # if there are multiple cookies that meet passed in criteria
                            raise CookieConflictError('There are multiple cookies with name, %r' % (name))
                        toReturn = cookie.value  # we will eventually return this as long as no cookie conflict
    
        if toReturn:
            return toReturn
>       raise KeyError('name=%r, domain=%r, path=%r' % (name, domain, path))
E       KeyError: "name='foo', domain=None, path=None"

requests/cookies.py:341: KeyError
__________________ RequestsTestCase.test_unicode_method_name ___________________

self = <test_requests.RequestsTestCase testMethod=test_unicode_method_name>

    def test_unicode_method_name(self):
        files = {'file': open('test_requests.py', 'rb')}
        r = requests.request(
            method=u('POST'), url=httpbin('post'), files=files)
>       assert r.status_code == 200
E       assert 503 == 200
E        +  where 503 = <Response [503]>.status_code

test_requests.py:540: AssertionError
_________________ RequestsTestCase.test_unicode_multipart_post _________________

self = <test_requests.RequestsTestCase testMethod=test_unicode_multipart_post>

    def test_unicode_multipart_post(self):
        r = requests.post(httpbin('post'),
            data={'stuff': u('ëlïxr')},
            files={'file': ('test_requests.py', open(__file__, 'rb'))})
>       assert r.status_code == 200
E       assert 503 == 200
E        +  where 503 = <Response [503]>.status_code

test_requests.py:508: AssertionError
_______________ RequestsTestCase.test_uppercase_scheme_redirect ________________

self = <test_requests.RequestsTestCase testMethod=test_uppercase_scheme_redirect>

    def test_uppercase_scheme_redirect(self):
        parts = urlparse(httpbin('html'))
        url = "HTTP://" + parts.netloc + parts.path
        r = requests.get(httpbin('redirect-to'), params={'url': url})
>       assert r.status_code == 200
E       assert 503 == 200
E        +  where 503 = <Response [503]>.status_code

test_requests.py:858: AssertionError
_________ RequestsTestCase.test_urlencoded_get_query_multivalued_param _________

self = <test_requests.RequestsTestCase testMethod=test_urlencoded_get_query_multivalued_param>

    def test_urlencoded_get_query_multivalued_param(self):
    
        r = requests.get(httpbin('get'), params=dict(test=['foo', 'baz']))
>       assert r.status_code == 200
E       assert 503 == 200
E        +  where 503 = <Response [503]>.status_code

test_requests.py:494: AssertionError
__________________ RequestsTestCase.test_user_agent_transfers __________________

self = <test_requests.RequestsTestCase testMethod=test_user_agent_transfers>

    def test_user_agent_transfers(self):
    
        heads = {
            'User-agent': 'Mozilla/5.0 (github.com/kennethreitz/requests)'
        }
    
        r = requests.get(httpbin('user-agent'), headers=heads)
>       assert heads['User-agent'] in r.text
E       AssertionError: assert 'Mozilla/5.0 (github.com/kennethreitz/requests)' in '<html>\r\n<head><title>503 Service Temporarily Unavailable</title></head>\r\n<body>\r\n<center><h1>503 Service Temporarily Unavailable</h1></center>\r\n</body>\r\n</html>\r\n'
E        +  where '<html>\r\n<head><title>503 Service Temporarily Unavailable</title></head>\r\n<body>\r\n<center><h1>503 Service Temporarily Unavailable</h1></center>\r\n</body>\r\n</html>\r\n' = <Response [503]>.text

test_requests.py:273: AssertionError
________________________ TestTimeout.test_none_timeout _________________________

self = <test_requests.TestTimeout object at 0x7fc4db8d8190>

    def test_none_timeout(self):
        """ Check that you can set None as a valid timeout value.
    
        To actually test this behavior, we'd want to check that setting the
        timeout to None actually lets the request block past the system default
        timeout. However, this would make the test suite unbearably slow.
        Instead we verify that setting the timeout to None does not prevent the
        request from succeeding.
        """
        r = requests.get(httpbin('get'), timeout=None)
>       assert r.status_code == 200
E       assert 503 == 200
E        +  where 503 = <Response [503]>.status_code

test_requests.py:1491: AssertionError
________________________ TestTimeout.test_read_timeout _________________________

self = <test_requests.TestTimeout object at 0x7fc4db8d8a90>

    def test_read_timeout(self):
        try:
            requests.get(httpbin('delay/10'), timeout=(None, 0.1))
>           assert False, "The recv() request should time out."
E           AssertionError: The recv() request should time out.
E           assert False

test_requests.py:1496: AssertionError
_______________________ TestTimeout.test_encoded_methods _______________________

self = <test_requests.TestTimeout object at 0x7fc4db8d85b0>

    def test_encoded_methods(self):
        """See: https://github.com/kennethreitz/requests/issues/2316"""
        r = requests.request(b'GET', httpbin('get'))
>       assert r.ok
E       assert False
E        +  where False = <Response [503]>.ok

test_requests.py:1518: AssertionError
_____________________________ test_urllib3_retries _____________________________

    def test_urllib3_retries():
        from requests.packages.urllib3.util import Retry
        s = requests.Session()
        s.mount('http://', HTTPAdapter(max_retries=Retry(
            total=2, status_forcelist=[500]
        )))
    
        with pytest.raises(RetryError):
>           s.get(httpbin('status/500'))
E           Failed: DID NOT RAISE <class 'requests.exceptions.RetryError'>

test_requests.py:1656: Failed
_____________________ test_urllib3_pool_connection_closed ______________________

self = <requests.packages.urllib3.connectionpool.HTTPConnectionPool object at 0x7fc4dab65be0>
timeout = None

    def _get_conn(self, timeout=None):
        """
        Get a connection. Will return a pooled connection if one is available.
    
        If no connections are available and :prop:`.block` is ``False``, then a
        fresh connection is returned.
    
        :param timeout:
            Seconds to wait before giving up and raising
            :class:`urllib3.exceptions.EmptyPoolError` if the pool is empty and
            :prop:`.block` is ``True``.
        """
        conn = None
        try:
>           conn = self.pool.get(block=self.block, timeout=timeout)
E           AttributeError: 'NoneType' object has no attribute 'get'

requests/packages/urllib3/connectionpool.py:224: AttributeError

During handling of the above exception, another exception occurred:

    def test_urllib3_pool_connection_closed():
        s = requests.Session()
        s.mount('http://', HTTPAdapter(pool_connections=0, pool_maxsize=0))
    
        try:
>           s.get(httpbin('status/200'))

test_requests.py:1664: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
requests/sessions.py:477: in get
    return self.request('GET', url, **kwargs)
requests/sessions.py:465: in request
    resp = self.send(prep, **send_kwargs)
requests/sessions.py:573: in send
    r = adapter.send(request, **kwargs)
requests/adapters.py:361: in send
    resp = conn.urlopen(
requests/packages/urllib3/connectionpool.py:533: in urlopen
    conn = self._get_conn(timeout=pool_timeout)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <requests.packages.urllib3.connectionpool.HTTPConnectionPool object at 0x7fc4dab65be0>
timeout = None

    def _get_conn(self, timeout=None):
        """
        Get a connection. Will return a pooled connection if one is available.
    
        If no connections are available and :prop:`.block` is ``False``, then a
        fresh connection is returned.
    
        :param timeout:
            Seconds to wait before giving up and raising
            :class:`urllib3.exceptions.EmptyPoolError` if the pool is empty and
            :prop:`.block` is ``True``.
        """
        conn = None
        try:
            conn = self.pool.get(block=self.block, timeout=timeout)
    
        except AttributeError:  # self.pool is None
>           raise ClosedPoolError(self, "Pool is closed.")
E           requests.packages.urllib3.exceptions.ClosedPoolError: HTTPConnectionPool(host='httpbin.org', port=80): Pool is closed.

requests/packages/urllib3/connectionpool.py:227: ClosedPoolError
=============================== warnings summary ===============================
requests/packages/urllib3/connectionpool.py:95
  /testbed/requests/packages/urllib3/connectionpool.py:95: DeprecationWarning: invalid escape sequence \*
    """

requests/packages/urllib3/connectionpool.py:424
  /testbed/requests/packages/urllib3/connectionpool.py:424: DeprecationWarning: invalid escape sequence \*
    """

requests/packages/urllib3/connectionpool.py:772
  /testbed/requests/packages/urllib3/connectionpool.py:772: DeprecationWarning: invalid escape sequence \*
    """

requests/packages/urllib3/_collections.py:1
requests/packages/urllib3/_collections.py:1
  /testbed/requests/packages/urllib3/_collections.py:1: DeprecationWarning: Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.10 it will stop working
    from collections import Mapping, MutableMapping

requests/packages/urllib3/poolmanager.py:32
  /testbed/requests/packages/urllib3/poolmanager.py:32: DeprecationWarning: invalid escape sequence \*
    """

requests/models.py:783
  /testbed/requests/models.py:783: DeprecationWarning: invalid escape sequence \*
    """Returns the json-encoded content of a response, if any.

requests/api.py:59
  /testbed/requests/api.py:59: DeprecationWarning: invalid escape sequence \*
    """Sends a GET request.

requests/api.py:73
  /testbed/requests/api.py:73: DeprecationWarning: invalid escape sequence \*
    """Sends a OPTIONS request.

requests/api.py:86
  /testbed/requests/api.py:86: DeprecationWarning: invalid escape sequence \*
    """Sends a HEAD request.

requests/api.py:99
  /testbed/requests/api.py:99: DeprecationWarning: invalid escape sequence \*
    """Sends a POST request.

requests/api.py:113
  /testbed/requests/api.py:113: DeprecationWarning: invalid escape sequence \*
    """Sends a PUT request.

requests/api.py:126
  /testbed/requests/api.py:126: DeprecationWarning: invalid escape sequence \*
    """Sends a PATCH request.

requests/api.py:139
  /testbed/requests/api.py:139: DeprecationWarning: invalid escape sequence \*
    """Sends a DELETE request.

requests/sessions.py:470
  /testbed/requests/sessions.py:470: DeprecationWarning: invalid escape sequence \*
    """Sends a GET request. Returns :class:`Response` object.

requests/sessions.py:480
  /testbed/requests/sessions.py:480: DeprecationWarning: invalid escape sequence \*
    """Sends a OPTIONS request. Returns :class:`Response` object.

requests/sessions.py:490
  /testbed/requests/sessions.py:490: DeprecationWarning: invalid escape sequence \*
    """Sends a HEAD request. Returns :class:`Response` object.

requests/sessions.py:500
  /testbed/requests/sessions.py:500: DeprecationWarning: invalid escape sequence \*
    """Sends a POST request. Returns :class:`Response` object.

requests/sessions.py:511
  /testbed/requests/sessions.py:511: DeprecationWarning: invalid escape sequence \*
    """Sends a PUT request. Returns :class:`Response` object.

requests/sessions.py:521
  /testbed/requests/sessions.py:521: DeprecationWarning: invalid escape sequence \*
    """Sends a PATCH request. Returns :class:`Response` object.

requests/sessions.py:531
  /testbed/requests/sessions.py:531: DeprecationWarning: invalid escape sequence \*
    """Sends a DELETE request. Returns :class:`Response` object.

test_requests.py::RequestsTestCase::test_BASICAUTH_TUPLE_HTTP_200_OK_GET
  /testbed/requests/models.py:168: DeprecationWarning: Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.10 it will stop working
    if isinstance(hook, collections.Callable):

test_requests.py::TestContentEncodingDetection::test_html4_pragma
test_requests.py::TestContentEncodingDetection::test_html_charset
test_requests.py::TestContentEncodingDetection::test_none
test_requests.py::TestContentEncodingDetection::test_precedence
test_requests.py::TestContentEncodingDetection::test_xhtml_pragma
test_requests.py::TestContentEncodingDetection::test_xml
  /testbed/requests/utils.py:294: DeprecationWarning: In requests 3.0, get_encodings_from_content will be removed. For more information, please see the discussion on issue #2266. (This warning should only appear once.)
    warnings.warn((

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
==================================== PASSES ====================================
=========================== short test summary info ============================
PASSED test_requests.py::RequestsTestCase::test_BASICAUTH_TUPLE_HTTP_200_OK_GET
PASSED test_requests.py::RequestsTestCase::test_DIGESTAUTH_QUOTES_QOP_VALUE
PASSED test_requests.py::RequestsTestCase::test_DIGESTAUTH_WRONG_HTTP_401_GET
PASSED test_requests.py::RequestsTestCase::test_DIGEST_AUTH_RETURNS_COOKIE
PASSED test_requests.py::RequestsTestCase::test_DIGEST_AUTH_SETS_SESSION_COOKIES
PASSED test_requests.py::RequestsTestCase::test_DIGEST_HTTP_200_OK_GET
PASSED test_requests.py::RequestsTestCase::test_DIGEST_STREAM
PASSED test_requests.py::RequestsTestCase::test_HTTP_200_OK_GET_ALTERNATIVE
PASSED test_requests.py::RequestsTestCase::test_HTTP_200_OK_GET_WITH_MIXED_PARAMS
PASSED test_requests.py::RequestsTestCase::test_HTTP_200_OK_GET_WITH_PARAMS
PASSED test_requests.py::RequestsTestCase::test_HTTP_200_OK_HEAD
PASSED test_requests.py::RequestsTestCase::test_HTTP_200_OK_PUT
PASSED test_requests.py::RequestsTestCase::test_HTTP_302_ALLOW_REDIRECT_GET
PASSED test_requests.py::RequestsTestCase::test_LocationParseError
PASSED test_requests.py::RequestsTestCase::test_POSTBIN_GET_POST_FILES
PASSED test_requests.py::RequestsTestCase::test_POSTBIN_GET_POST_FILES_WITH_DATA
PASSED test_requests.py::RequestsTestCase::test_auth_is_retained_for_redirect_on_host
PASSED test_requests.py::RequestsTestCase::test_auth_is_stripped_on_redirect_off_host
PASSED test_requests.py::RequestsTestCase::test_autoset_header_values_are_native
PASSED test_requests.py::RequestsTestCase::test_basic_auth_str_is_always_native
PASSED test_requests.py::RequestsTestCase::test_basic_building
PASSED test_requests.py::RequestsTestCase::test_basicauth_with_netrc
PASSED test_requests.py::RequestsTestCase::test_can_send_bytes_bytearray_objects_with_files
PASSED test_requests.py::RequestsTestCase::test_can_send_file_object_with_non_string_filename
PASSED test_requests.py::RequestsTestCase::test_can_send_nonstring_objects_with_files
PASSED test_requests.py::RequestsTestCase::test_cannot_send_unprepared_requests
PASSED test_requests.py::RequestsTestCase::test_connection_error_invalid_domain
PASSED test_requests.py::RequestsTestCase::test_connection_error_invalid_port
PASSED test_requests.py::RequestsTestCase::test_cookie_as_dict_items
PASSED test_requests.py::RequestsTestCase::test_cookie_as_dict_keeps_items
PASSED test_requests.py::RequestsTestCase::test_cookie_as_dict_keeps_len
PASSED test_requests.py::RequestsTestCase::test_cookie_as_dict_keys
PASSED test_requests.py::RequestsTestCase::test_cookie_as_dict_values
PASSED test_requests.py::RequestsTestCase::test_cookie_parameters
PASSED test_requests.py::RequestsTestCase::test_cookie_persists_via_api
PASSED test_requests.py::RequestsTestCase::test_cookie_quote_wrapped
PASSED test_requests.py::RequestsTestCase::test_cookie_removed_on_expire
PASSED test_requests.py::RequestsTestCase::test_cookie_sent_on_redirect
PASSED test_requests.py::RequestsTestCase::test_decompress_gzip
PASSED test_requests.py::RequestsTestCase::test_entry_points
PASSED test_requests.py::RequestsTestCase::test_fixes_1329
PASSED test_requests.py::RequestsTestCase::test_get_auth_from_url
PASSED test_requests.py::RequestsTestCase::test_get_auth_from_url_encoded_hashes
PASSED test_requests.py::RequestsTestCase::test_get_auth_from_url_encoded_spaces
PASSED test_requests.py::RequestsTestCase::test_get_auth_from_url_not_encoded_spaces
PASSED test_requests.py::RequestsTestCase::test_get_auth_from_url_percent_chars
PASSED test_requests.py::RequestsTestCase::test_header_keys_are_native
PASSED test_requests.py::RequestsTestCase::test_header_remove_is_case_insensitive
PASSED test_requests.py::RequestsTestCase::test_headers_on_session_with_None_are_not_sent
PASSED test_requests.py::RequestsTestCase::test_history_is_always_a_list
PASSED test_requests.py::RequestsTestCase::test_hook_receives_request_arguments
PASSED test_requests.py::RequestsTestCase::test_http_error
PASSED test_requests.py::RequestsTestCase::test_invalid_url
PASSED test_requests.py::RequestsTestCase::test_links
PASSED test_requests.py::RequestsTestCase::test_long_authinfo_in_url
PASSED test_requests.py::RequestsTestCase::test_no_content_length
PASSED test_requests.py::RequestsTestCase::test_nonhttp_schemes_dont_check_URLs
PASSED test_requests.py::RequestsTestCase::test_override_content_length
PASSED test_requests.py::RequestsTestCase::test_params_are_added_before_fragment
PASSED test_requests.py::RequestsTestCase::test_path_is_not_double_encoded
PASSED test_requests.py::RequestsTestCase::test_prepare_request_with_bytestring_url
PASSED test_requests.py::RequestsTestCase::test_prepared_request_hook
PASSED test_requests.py::RequestsTestCase::test_pyopenssl_redirect
PASSED test_requests.py::RequestsTestCase::test_request_and_response_are_pickleable
PASSED test_requests.py::RequestsTestCase::test_request_cookies_not_persisted
PASSED test_requests.py::RequestsTestCase::test_request_ok_set
PASSED test_requests.py::RequestsTestCase::test_requests_in_history_are_not_overridden
PASSED test_requests.py::RequestsTestCase::test_response_decode_unicode
PASSED test_requests.py::RequestsTestCase::test_response_is_iterable
PASSED test_requests.py::RequestsTestCase::test_session_hooks_are_overriden_by_request_hooks
PASSED test_requests.py::RequestsTestCase::test_session_hooks_are_used_with_no_request_hooks
PASSED test_requests.py::RequestsTestCase::test_status_raising
PASSED test_requests.py::RequestsTestCase::test_time_elapsed_blank
PASSED test_requests.py::RequestsTestCase::test_transport_adapter_ordering
PASSED test_requests.py::RequestsTestCase::test_unconsumed_session_response_closes_connection
PASSED test_requests.py::RequestsTestCase::test_unicode_get
PASSED test_requests.py::RequestsTestCase::test_unicode_header_name
PASSED test_requests.py::RequestsTestCase::test_unicode_multipart_post_fieldnames
PASSED test_requests.py::TestContentEncodingDetection::test_html4_pragma
PASSED test_requests.py::TestContentEncodingDetection::test_html_charset
PASSED test_requests.py::TestContentEncodingDetection::test_none
PASSED test_requests.py::TestContentEncodingDetection::test_precedence
PASSED test_requests.py::TestContentEncodingDetection::test_xhtml_pragma
PASSED test_requests.py::TestContentEncodingDetection::test_xml
PASSED test_requests.py::TestCaseInsensitiveDict::test_contains
PASSED test_requests.py::TestCaseInsensitiveDict::test_copy
PASSED test_requests.py::TestCaseInsensitiveDict::test_delitem
PASSED test_requests.py::TestCaseInsensitiveDict::test_docstring_example
PASSED test_requests.py::TestCaseInsensitiveDict::test_equality
PASSED test_requests.py::TestCaseInsensitiveDict::test_fixes_649
PASSED test_requests.py::TestCaseInsensitiveDict::test_get
PASSED test_requests.py::TestCaseInsensitiveDict::test_getitem
PASSED test_requests.py::TestCaseInsensitiveDict::test_iter
PASSED test_requests.py::TestCaseInsensitiveDict::test_iterable_init
PASSED test_requests.py::TestCaseInsensitiveDict::test_kwargs_init
PASSED test_requests.py::TestCaseInsensitiveDict::test_len
PASSED test_requests.py::TestCaseInsensitiveDict::test_lower_items
PASSED test_requests.py::TestCaseInsensitiveDict::test_mapping_init
PASSED test_requests.py::TestCaseInsensitiveDict::test_preserve_key_case
PASSED test_requests.py::TestCaseInsensitiveDict::test_preserve_last_key_case
PASSED test_requests.py::TestCaseInsensitiveDict::test_repr
PASSED test_requests.py::TestCaseInsensitiveDict::test_setdefault
PASSED test_requests.py::TestCaseInsensitiveDict::test_update
PASSED test_requests.py::TestCaseInsensitiveDict::test_update_retains_unchanged
PASSED test_requests.py::UtilsTestCase::test_address_in_network
PASSED test_requests.py::UtilsTestCase::test_dotted_netmask
PASSED test_requests.py::UtilsTestCase::test_get_auth_from_url
PASSED test_requests.py::UtilsTestCase::test_get_environ_proxies
PASSED test_requests.py::UtilsTestCase::test_get_environ_proxies_ip_ranges
PASSED test_requests.py::UtilsTestCase::test_guess_filename_when_filename_is_an_int
PASSED test_requests.py::UtilsTestCase::test_guess_filename_when_int
PASSED test_requests.py::UtilsTestCase::test_guess_filename_with_file_like_obj
PASSED test_requests.py::UtilsTestCase::test_guess_filename_with_unicode_name
PASSED test_requests.py::UtilsTestCase::test_is_ipv4_address
PASSED test_requests.py::UtilsTestCase::test_is_valid_cidr
PASSED test_requests.py::UtilsTestCase::test_requote_uri_properly_requotes
PASSED test_requests.py::UtilsTestCase::test_requote_uri_with_unquoted_percents
PASSED test_requests.py::UtilsTestCase::test_super_len_io_streams
PASSED test_requests.py::TestMorselToCookieExpires::test_expires_invalid_int
PASSED test_requests.py::TestMorselToCookieExpires::test_expires_invalid_str
PASSED test_requests.py::TestMorselToCookieExpires::test_expires_none
PASSED test_requests.py::TestMorselToCookieExpires::test_expires_valid_str
PASSED test_requests.py::TestMorselToCookieMaxAge::test_max_age_invalid_str
PASSED test_requests.py::TestMorselToCookieMaxAge::test_max_age_valid_int
PASSED test_requests.py::TestTimeout::test_stream_timeout
PASSED test_requests.py::TestTimeout::test_invalid_timeout
PASSED test_requests.py::TestTimeout::test_connect_timeout
PASSED test_requests.py::TestTimeout::test_total_timeout_connect
PASSED test_requests.py::TestRedirects::test_requests_are_updated_each_time
PASSED test_requests.py::test_data_argument_accepts_tuples
PASSED test_requests.py::test_prepared_request_empty_copy
PASSED test_requests.py::test_prepared_request_no_cookies_copy
PASSED test_requests.py::test_prepared_request_complete_copy
PASSED test_requests.py::test_prepare_unicode_url
PASSED test_requests.py::test_vendor_aliases
XFAIL test_requests.py::RequestsTestCase::test_response_iter_lines_reentrant
FAILED test_requests.py::RequestsTestCase::test_conflicting_post_params - Typ...
FAILED test_requests.py::RequestsTestCase::test_custom_content_type - assert ...
FAILED test_requests.py::RequestsTestCase::test_different_encodings_dont_break_post
FAILED test_requests.py::RequestsTestCase::test_generic_cookiejar_works - jso...
FAILED test_requests.py::RequestsTestCase::test_json_param_post_content_type_works
FAILED test_requests.py::RequestsTestCase::test_manual_redirect_with_partial_body_read
FAILED test_requests.py::RequestsTestCase::test_mixed_case_scheme_acceptable
FAILED test_requests.py::RequestsTestCase::test_param_cookiejar_works - json....
FAILED test_requests.py::RequestsTestCase::test_params_are_merged_case_sensitive
FAILED test_requests.py::RequestsTestCase::test_prepared_from_session - json....
FAILED test_requests.py::RequestsTestCase::test_redirect_with_wrong_gzipped_header
FAILED test_requests.py::RequestsTestCase::test_request_cookie_overrides_session_cookie
FAILED test_requests.py::RequestsTestCase::test_requests_history_is_saved - I...
FAILED test_requests.py::RequestsTestCase::test_response_iter_lines - assert ...
FAILED test_requests.py::RequestsTestCase::test_session_pickling - assert 503...
FAILED test_requests.py::RequestsTestCase::test_set_cookie_on_301 - KeyError:...
FAILED test_requests.py::RequestsTestCase::test_unicode_method_name - assert ...
FAILED test_requests.py::RequestsTestCase::test_unicode_multipart_post - asse...
FAILED test_requests.py::RequestsTestCase::test_uppercase_scheme_redirect - a...
FAILED test_requests.py::RequestsTestCase::test_urlencoded_get_query_multivalued_param
FAILED test_requests.py::RequestsTestCase::test_user_agent_transfers - Assert...
FAILED test_requests.py::TestTimeout::test_none_timeout - assert 503 == 200
FAILED test_requests.py::TestTimeout::test_read_timeout - AssertionError: The...
FAILED test_requests.py::TestTimeout::test_encoded_methods - assert False
FAILED test_requests.py::test_urllib3_retries - Failed: DID NOT RAISE <class ...
FAILED test_requests.py::test_urllib3_pool_connection_closed - requests.packa...
====== 26 failed, 135 passed, 1 xfailed, 28 warnings in 257.65s (0:04:17) ======
+ : '>>>>> End Test Output'
+ git checkout 0be38a0c37c59c4b66ce908731da15b401655113 test_requests.py
Updated 1 path from ccc7cab3
